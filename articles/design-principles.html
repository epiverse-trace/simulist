<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="simulist">
<title>Design Principles for {simulist} • simulist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Design Principles for {simulist}">
<meta property="og:description" content="simulist">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">simulist</a>

    <small class="nav-text text-danger me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/simulist.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Package Vignettes</h6>
    <a class="dropdown-item" href="../articles/age-strat-rates.html">Age-stratified hospitalisation and death rates</a>
    <a class="dropdown-item" href="../articles/age-struct-pop.html">Age structured population</a>
    <a class="dropdown-item" href="../articles/vis-linelist.html">Visualising simulated data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6>
    <a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {simulist}</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/simulist/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Design Principles for {simulist}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/simulist/blob/HEAD/vignettes/design-principles.Rmd" class="external-link"><code>vignettes/design-principles.Rmd</code></a></small>
      <div class="d-none name"><code>design-principles.Rmd</code></div>
    </div>

    
    
<p>This vignette outlines the design decisions that have been taken
during the development of the {simulist} R package, and provides some of
the reasoning, and possible pros and cons of each decision.</p>
<p>This document is primarily intended to be read by those interested in
understanding the code within the package and for potential package
contributors.</p>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>The {simulist} package aims to simulate data on infectious disease
outbreaks, primarily line list data, but also contacts data. Each of
these output types have an associated exported function:
<code><a href="../reference/sim_linelist.html">sim_linelist()</a></code> and <code><a href="../reference/sim_contacts.html">sim_contacts()</a></code>. There is
also a function to simulate and output both of these data types,
<code><a href="../reference/sim_outbreak.html">sim_outbreak()</a></code>. This latter function is useful for
interoperability with the <a href="https://CRAN.R-project.org/package=epicontacts" class="external-link">{epicontacts} R
package</a> (see <a href="vis-linelist.html">visualisation
vignette</a>), and provides linked line list and contacts datasets,
which are common in outbreaks, such as the MERS dataset within the <a href="https://CRAN.R-project.org/package=outbreaks" class="external-link">{outbreaks} R
package</a>.</p>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>The simulation functions either return a
<code>&lt;data.frame&gt;</code> or a <code>list</code> of
<code>&lt;data.frame&gt;</code>s. This consistency across functions of a
well-known data structure makes it easy to understand for users.</p>
</div>
<div class="section level2">
<h2 id="design-decisions">Design decisions<a class="anchor" aria-label="anchor" href="#design-decisions"></a>
</h2>
<ul>
<li><p>When using age-stratified rates of hospitalisation and deaths
(see <a href="age-strat-rates.html">Age-stratified hospitalisation and
death rates vignette</a> for details) there is an interaction between
function arguments. The <code>&lt;data.frame&gt;</code> that defines the
age-stratification in <code>hosp_rate</code>,
<code>hosp_death_rate</code> and <code>non_hosp_death_rate</code>
arguments gives the lower bound of the age groups. The upper bound of
the age groups is derived from the next lower bound, but the upper bound
oldest age group is defined by the upper age given to the
<code>population_age</code> argument. This interaction of arguments is
not ideal, as it can be more difficult to understand for users (as
outlined in <a href="https://design.tidyverse.org/independent-meaning.html#whats-the-problem" class="external-link">The
Tidy Design book</a>), however, the interaction does not change the
interpretation of each argument which would be more convoluted. This
design decision was taken when we changed the structure of the
<code>&lt;data.frame&gt;</code> accepted as input to the
<code>*_rate</code> arguments from having two columns for a lower and
upper age limit, to a single column of lower age bounds. This change was
made in <a href="https://github.com/epiverse-trace/simulist/pull/14" class="external-link">pull request
#14</a> and follows the design of <a href="https://github.com/epiforecasts/socialmixr/blob/main/R/contact_matrix.r" class="external-link">{socialmixr}</a>
for defining age bounds. The newer structure is judged to be preferred
as it prevents input errors by the user when the age bounds are
overlapping or non-contiguous (i.e. missing age groups).</p></li>
<li><p>The column names of the contact relationships (edges of the
network) are called <code>from</code> and <code>to</code>. Names of
contacts table match {epicontacts} <code>&lt;epicontacts&gt;</code>
objects. If the column names of the two contacts provided to
<code><a href="https://www.repidemicsconsortium.org/epicontacts/reference/make_epicontacts.html" class="external-link">epicontacts::make_epicontacts()</a></code> arguments <code>from</code>
and <code>to</code> are not <code>from</code> and <code>to</code> they
will be silently renamed in the resulting
<code>&lt;epicontacts&gt;</code> object. By making these column names
<code>from</code> and <code>to</code> when output from
<code><a href="../reference/sim_contacts.html">sim_contacts()</a></code> or <code><a href="../reference/sim_outbreak.html">sim_outbreak()</a></code> it prevents
any confusion when used with {epicontacts}. This names are also
preferred as they are usefully descriptive.</p></li>
<li><p>The <a href="vis-linelist.html">Visualising simulated data
vignette</a> contains interactive data visualisation when rendered to
the web. This enforces some limitations. The vignette uses
<code>output: rmarkdown::html_document()</code> instead of
<code>output: bookdown::html_vignette2</code> and does not contain
<code>pkgdown: as_is: true</code> in the yaml metadata, in order for the
interactive figures to render and operate correctly. This means that the
vignette figures will not automatically be numbered and start with
“Figure <em>x</em>” (where <em>x</em> is replaced by a number). Instead,
it was decided for this vignette that this information would be manually
written, and then manually updated if the number or order of the figures
changed. This is not an ideal solution and automation is preferred, but
on balance, it was decided that the addition of interactive
visualisation from {epicontacts} outweighed the downside of manual
figure labelling.</p></li>
<li><p>Exported functions that simulate data use the naming convention
<code>sim_*()</code> (where <code>*</code> is the placeholder). Internal
functions that simulate have a dot (<code>.</code>) prefix
(e.g. <code><a href="../reference/dot-sim_utils.html">.sim_bp_linelist()</a></code>). Functions that create fixed data
structures (i.e. data factory functions) have the naming convention
(<code>create_*()</code> or <code>.create_*()</code>).</p></li>
<li><p>The use of a <code>config</code> argument in the simulation
function is to reduce the number of arguments in the exported functions
and provide as simple a user-interface as possible. The choice of what
gets an argument in the function body and what is confined to
<code>config</code> list is based on preconceived frequency of use,
importance and technical detail. That is to say, settings that are
unlikely to be changed by the user or if they are changed require an
advanced understanding of the simulation model are placed within the
<code>config</code>, and given default values with
<code><a href="../reference/create_config.html">create_config()</a></code>.</p></li>
<li><p>The column names of the line list data produced by
<code><a href="../reference/sim_linelist.html">sim_linelist()</a></code> and <code><a href="../reference/sim_outbreak.html">sim_outbreak()</a></code> matches the
tag names used in the <a href="https://CRAN.R-project.org/package=linelist" class="external-link">{linelist} R
package</a> (an <a href="https://github.com/epiverse-trace" class="external-link">Epiverse-TRACE R package</a>).
This is for continuity of design more than any functional reason. The
line list data from {simulist} functions is not tagged <em>sensu</em> <a href="https://epiverse-trace.github.io/linelist/articles/linelist.html" class="external-link">{linelist}
tagging</a>. There is an inconsistent use of <em>hospitalisation</em>
and <em>admission</em>; in the simulated line list it is
<code>date_admission</code>, but internally the package uses
hospitalisation (e.g. <code><a href="../reference/dot-add_date.html">.add_hospitalisation()</a></code>). This is
because I think <em>hospitalisation</em> is more descriptive but
<code>date_admission</code> is used by {linelist}.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>The aim is to restrict the number of dependencies to a minimal
required set for ease of maintenance. The current hard dependencies
are:</p>
<ul>
<li>{stats}</li>
<li><a href="https://CRAN.R-project.org/package=checkmate" class="external-link">{checkmate}</a></li>
<li><a href="https://github.com/epiverse-trace/epiparameter" class="external-link">{epiparameter}</a></li>
<li><a href="https://github.com/epiverse-trace/bpmodels" class="external-link">{bpmodels}</a></li>
<li><a href="https://CRAN.R-project.org/package=randomNames" class="external-link">{randomNames}</a></li>
</ul>
<p>{stats} is distributed with the R language so is viewed as a
lightweight dependency, that should already be installed on a user’s
machine if they have R. {checkmate} is an input checking package widely
used across Epiverse-TRACE packages. {epiparameter} is used to easily
access epidemiological parameters from the package’s library, the
package is currently unstable and actively developed, however, by using
it in another package it can inform the development path of
{epiparameter}. {bpmodels} is used to handle the single-type branching
process model, this is taken on as a dependency as implementing
different transmission models within {simulist} is beyond the package
scope and does not scale as we implement more models to generate line
list data. {randomNames} provides a utility function for generating
random names for case and contact data. The functionality could be
replicated in {simulist}, however the {randomNames} package is
maintained and contains a range of name generation settings which
warrants its use as a dependency.</p>
<p>The soft dependencies (and their minimum version requirements)
are:</p>
<ul>
<li>
<a href="https://CRAN.R-project.org/package=incidence2" class="external-link">{incidence2}</a>
(&gt;= 2.1.0)</li>
<li>
<a href="https://CRAN.R-project.org/package=epicontacts" class="external-link">{epicontacts}</a>
(&gt;= 1.1.3)</li>
<li><a href="https://CRAN.R-project.org/package=knitr" class="external-link">{knitr}</a></li>
<li><a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">{ggplot2}</a></li>
<li><a href="https://CRAN.R-project.org/package=bookdown" class="external-link">{bookdown}</a></li>
<li><a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">{rmarkdown}</a></li>
<li><a href="https://CRAN.R-project.org/package=spelling" class="external-link">{spelling}</a></li>
<li>
<a href="https://CRAN.R-project.org/package=testthat" class="external-link">{testthat}</a>
(&gt;= 3.0.0)</li>
</ul>
<p>{knitr}, {bookdown}, {rmarkdown}, are all used for generating
documentation. {spelling} and {testthat} are used for testing the code
base. {ggplot2} is used for plotting within the vignettes. {incidence2}
and {epicontacts} are used in vignettes to demonstrate interoperability
with downstream packages, with a focus on data visualisation.</p>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>There are no special requirements to contributing to {simulist},
please follow the <a href="https://github.com/epiverse-trace/.github/blob/main/CONTRIBUTING.md" class="external-link">package
contributing guide</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua W. Lambert, Carmen Tamayo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
