<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Age-structured population • simulist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Age-structured population">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">simulist</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/simulist.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Customising simulated outbreak</h6></li>
    <li><a class="dropdown-item" href="../articles/age-strat-risks.html">Age-stratified hospitalisation and death risks</a></li>
    <li><a class="dropdown-item" href="../articles/age-struct-pop.html">Age-structured population</a></li>
    <li><a class="dropdown-item" href="../articles/time-varying-cfr.html">Time-varying case fatality risk</a></li>
    <li><a class="dropdown-item" href="../articles/reporting-delays-truncation.html">Reporting delays and right-truncation of line list data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Wrangling and plotting data</h6></li>
    <li><a class="dropdown-item" href="../articles/wrangling-linelist.html">Wrangling simulated outbreak data</a></li>
    <li><a class="dropdown-item" href="../articles/vis-linelist.html">Visualising simulated data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {simulist}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/simulist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Age-structured population</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/simulist/blob/main/vignettes/age-struct-pop.Rmd" class="external-link"><code>vignettes/age-struct-pop.Rmd</code></a></small>
      <div class="d-none name"><code>age-struct-pop.Rmd</code></div>
    </div>

    
    
<div class="alert alert-info">
<p>If you are unfamiliar with the {simulist} package or the
<code><a href="../reference/sim_linelist.html">sim_linelist()</a></code> function <a href="simulist.html">Get Started
vignette</a> is a great place to start.</p>
</div>
<p>This vignette describes how to simulate a line list with either a
uniform or non-uniform distribution of ages within the population. This
population age structure may either describe the population of a region
as a whole, or specifically which age groups are more likely to become
infected than others.</p>
<p>The {simulist} package uses a branching process (using a random
network model of contacts), which is independent of population age
structure to simulate the line list, and then {simulist} <em>paints</em>
the demographic information onto the infected individuals (and in the
case of <code><a href="../reference/sim_outbreak.html">sim_outbreak()</a></code> or <code><a href="../reference/sim_contacts.html">sim_contacts()</a></code> the
contacts of infected individuals). In other words, once the cases in the
line list have been simulated the ages are assigned to each individual
post hoc, specified by the age range, and age structure, if
supplied.</p>
<p>The age range and age structure for the simulation functions
(<code>sim_*()</code>) in {simulist} is controlled by the
<code>population_age</code> argument. The default age structure in
{simulist} is a uniform structure between a lower and upper age range.
The <code><a href="../reference/sim_linelist.html">sim_linelist()</a></code> function (and other <code>sim_*()</code>
functions) can accept a <code>&lt;data.frame&gt;</code> instead of the
<code>numeric</code> vector to specify the age structure for specified
age groups. This feature can be especially useful when wanting to
simulate an outbreak in a region with a heavily non-uniform age
structure, <a href="https://ourworldindata.org/age-structure" class="external-link">for
example younger populations such as Nigeria, or older populations such
as Japan</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/simulist" class="external-link">simulist</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>First we load the requested delay distributions using the
{epiparameter} package. The onset-to-hospitalisation and onset-to-death
delay distributions are extracted from the {epiparameter} database, and
the contact distribution and the infectious period are manually defined
as they are not yet available from the {epiparameter} database.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/epiparameter.html" class="external-link">epiparameter</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"contact distribution"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/create_prob_distribution.html" class="external-link">create_prob_distribution</a></span><span class="op">(</span></span>
<span>    prob_distribution <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>    prob_distribution_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Citation cannot be created as author, year, journal or title is missing</span></span>
<span></span>
<span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/epiparameter.html" class="external-link">epiparameter</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"infectious period"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/create_prob_distribution.html" class="external-link">create_prob_distribution</a></span><span class="op">(</span></span>
<span>    prob_distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>    prob_distribution_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Citation cannot be created as author, year, journal or title is missing</span></span>
<span></span>
<span><span class="co"># get onset to hospital admission from {epiparameter} database</span></span>
<span><span class="va">onset_to_hosp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/epiparameter_db.html" class="external-link">epiparameter_db</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"onset to hospitalisation"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Using Linton N, Kobayashi T, Yang Y, Hayashi K, Akhmetzhanov A, Jung S, Yuan</span></span>
<span><span class="co">#&gt; B, Kinoshita R, Nishiura H (2020). "Incubation Period and Other</span></span>
<span><span class="co">#&gt; Epidemiological Characteristics of 2019 Novel Coronavirus Infections</span></span>
<span><span class="co">#&gt; with Right Truncation: A Statistical Analysis of Publicly Available</span></span>
<span><span class="co">#&gt; Case Data." _Journal of Clinical Medicine_. doi:10.3390/jcm9020538</span></span>
<span><span class="co">#&gt; &lt;https://doi.org/10.3390/jcm9020538&gt;.. </span></span>
<span><span class="co">#&gt; To retrieve the citation use the 'get_citation' function</span></span>
<span></span>
<span><span class="co"># get onset to death from {epiparameter} database</span></span>
<span><span class="va">onset_to_death</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/epiparameter_db.html" class="external-link">epiparameter_db</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"onset to death"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Using Linton N, Kobayashi T, Yang Y, Hayashi K, Akhmetzhanov A, Jung S, Yuan</span></span>
<span><span class="co">#&gt; B, Kinoshita R, Nishiura H (2020). "Incubation Period and Other</span></span>
<span><span class="co">#&gt; Epidemiological Characteristics of 2019 Novel Coronavirus Infections</span></span>
<span><span class="co">#&gt; with Right Truncation: A Statistical Analysis of Publicly Available</span></span>
<span><span class="co">#&gt; Case Data." _Journal of Clinical Medicine_. doi:10.3390/jcm9020538</span></span>
<span><span class="co">#&gt; &lt;https://doi.org/10.3390/jcm9020538&gt;.. </span></span>
<span><span class="co">#&gt; To retrieve the citation use the 'get_citation' function</span></span></code></pre></div>
<p>By setting the seed we ensure the output of the vignette remains the
same each time it is rendered. When using {simulist}, setting the seed
is not required unless you need to simulate the same line list multiple
times.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="uniform-population-age">Uniform population age<a class="anchor" aria-label="anchor" href="#uniform-population-age"></a>
</h2>
<p>By default <code><a href="../reference/sim_linelist.html">sim_linelist()</a></code> simulates individuals ages
assuming a uniform distribution between 1 and 90. To change this age
range, a vector of two numbers can be supplied to the
<code>population_age</code> argument. Here we simulate an outbreak in a
population with a population ranging from 5 to 75 (inclusive,
<code>[5,75]</code>).</p>
<p><strong><em>Note</em></strong>: all ages are assumed to be in the
unit of years and need to be integers (or at least <a href="https://rlang.r-lib.org/reference/is_integerish.html" class="external-link">“integerish”</a>
if stored as double).</p>
<p>All simulations in this vignette condition the simulation to have a
minimum outbreak size of 100 cases (<code>outbreak_size</code>, the
maximum outbreak size is left at <code>1e4</code>) to clearly visualise
the distribution of ages.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_linelist.html">sim_linelist</a></span><span class="op">(</span></span>
<span>  contact_distribution <span class="op">=</span> <span class="va">contact_distribution</span>,</span>
<span>  infectious_period <span class="op">=</span> <span class="va">infectious_period</span>,</span>
<span>  prob_infection <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  onset_to_hosp <span class="op">=</span> <span class="va">onset_to_hosp</span>,</span>
<span>  onset_to_death <span class="op">=</span> <span class="va">onset_to_death</span>,</span>
<span>  population_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">75</span><span class="op">)</span>,</span>
<span>  outbreak_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1e4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id         case_name case_type sex age date_onset date_reporting</span></span>
<span><span class="co">#&gt; 1  1   Jez-Mas Sanders suspected   m  63 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 2  2   Megan Cronkhite confirmed   f  56 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 3  3   Jenell Williams suspected   f   7 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 4  5   Erika Hornafius  probable   f  35 2023-01-02     2023-01-02</span></span>
<span><span class="co">#&gt; 5  6 Dillon Cunningham  probable   m  60 2023-01-02     2023-01-02</span></span>
<span><span class="co">#&gt; 6  8         Ian Lopez confirmed   m  38 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt;   date_admission   outcome date_outcome date_first_contact date_last_contact</span></span>
<span><span class="co">#&gt; 1           &lt;NA&gt; recovered         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-02        2023-01-03</span></span>
<span><span class="co">#&gt; 3           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-04        2023-01-05</span></span>
<span><span class="co">#&gt; 4     2023-01-06      died   2023-01-15         2022-12-30        2023-01-04</span></span>
<span><span class="co">#&gt; 5           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-01        2023-01-04</span></span>
<span><span class="co">#&gt; 6           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-05        2023-01-07</span></span>
<span><span class="co">#&gt;   ct_value</span></span>
<span><span class="co">#&gt; 1       NA</span></span>
<span><span class="co">#&gt; 2     25.5</span></span>
<span><span class="co">#&gt; 3       NA</span></span>
<span><span class="co">#&gt; 4       NA</span></span>
<span><span class="co">#&gt; 5       NA</span></span>
<span><span class="co">#&gt; 6     22.8</span></span></code></pre></div>
<p>We can plot the age distribution for individuals in the line list,
binned into 5 year categories.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#10BED2"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    binwidth <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of Individuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Age"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">75</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="age-struct-pop_files/figure-html/plot-age-range-1.png" alt="Age distribution of individuals in a simulated line list sampled from a uniform distribution between 5 and 75." width="768"><p class="caption">
Age distribution of individuals in a simulated line list sampled from a
uniform distribution between 5 and 75.
</p>
</div>
<p>If the <code>population_age</code> argument was left unspecified, it
would have assumed the default age range of 1 to 90
(<code>c(1, 90)</code>).</p>
</div>
<div class="section level2">
<h2 id="structured-population-age">Structured population age<a class="anchor" aria-label="anchor" href="#structured-population-age"></a>
</h2>
<p>To simulate with a non-uniform age structure we create a table
(<code>&lt;data.frame&gt;</code>) containing the age bounds of each age
bracket in the population and the proportion of the population made up
by that age group.</p>
<div class="alert alert-warning">
<p>The upper bound (maximum) of the population also needs to be
specified in the age structure <code>&lt;data.frame&gt;</code>,
therefore, the last element in the age limits column is taken as the
upper bound of the age in the population. All elements before the last
one are the lower bound of each age group.</p>
<p>The simplest way to set the maximum population age is to set the
proportion to zero.</p>
</div>
<p>For this example we will simulate a population where 30% of the
population are between 1 and 19, 40% of the population are between 20
and 59, and 30% are between 60 and 89. The age limits
(<code>$age_limit</code> column) is inclusive. There will be no
individuals in the population younger then 1 or older than 90.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  age_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span>, <span class="fl">60</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>  proportion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">age_struct</span></span>
<span><span class="co">#&gt;   age_limit proportion</span></span>
<span><span class="co">#&gt; 1         1        0.3</span></span>
<span><span class="co">#&gt; 2        20        0.4</span></span>
<span><span class="co">#&gt; 3        60        0.3</span></span>
<span><span class="co">#&gt; 4        90        0.0</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_linelist.html">sim_linelist</a></span><span class="op">(</span></span>
<span>  contact_distribution <span class="op">=</span> <span class="va">contact_distribution</span>,</span>
<span>  infectious_period <span class="op">=</span> <span class="va">infectious_period</span>,</span>
<span>  prob_infection <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  onset_to_hosp <span class="op">=</span> <span class="va">onset_to_hosp</span>,</span>
<span>  onset_to_death <span class="op">=</span> <span class="va">onset_to_death</span>,</span>
<span>  population_age <span class="op">=</span> <span class="va">age_struct</span>,</span>
<span>  outbreak_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1e4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id            case_name case_type sex age date_onset date_reporting</span></span>
<span><span class="co">#&gt; 1  1        Cycrena Hoots confirmed   f  68 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 2  3       James Manchego  probable   m  22 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 3  4       Jankeith Tatum confirmed   m  16 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 4  6       Tyrell Johnson confirmed   m  59 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 5  7          Keywon Mack suspected   m  31 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 6  8 Taajuddeen al-Badour confirmed   m  60 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt;   date_admission   outcome date_outcome date_first_contact date_last_contact</span></span>
<span><span class="co">#&gt; 1           &lt;NA&gt; recovered         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-01        2023-01-05</span></span>
<span><span class="co">#&gt; 3           &lt;NA&gt;      died   2023-01-11         2022-12-31        2023-01-04</span></span>
<span><span class="co">#&gt; 4           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-01        2023-01-02</span></span>
<span><span class="co">#&gt; 5           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-05        2023-01-05</span></span>
<span><span class="co">#&gt; 6           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-01        2023-01-03</span></span>
<span><span class="co">#&gt;   ct_value</span></span>
<span><span class="co">#&gt; 1     27.1</span></span>
<span><span class="co">#&gt; 2       NA</span></span>
<span><span class="co">#&gt; 3     25.6</span></span>
<span><span class="co">#&gt; 4     24.2</span></span>
<span><span class="co">#&gt; 5       NA</span></span>
<span><span class="co">#&gt; 6     24.6</span></span></code></pre></div>
<p>Again we can plot the age distribution to see the age structure for
individuals in the line list. Given the relative uniformity of the age
structure specified it is not greatly different from the uniform age
structure plotted above, other than having a higher upper age limit. The
data is binned into 5 year categories and facetted by sex.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"#10BED2"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    binwidth <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of Individuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Age"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="age-struct-pop_files/figure-html/plot-age-struct-1.png" alt="Age distribution of line list cases facetted by sex" width="768"><p class="caption">
Age distribution of line list cases facetted by sex
</p>
</div>
<p>An example for a much younger population could instead specify:</p>
<ul>
<li>
<code>0.4</code> (or 40%) for 1-9 years old</li>
<li>
<code>0.3</code> (or 30%) for 10-29 years old</li>
<li>
<code>0.2</code> (or 20%) for 30-59 years old</li>
<li>
<code>0.1</code> (or 10%) for 60-75 years old</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  age_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">75</span><span class="op">)</span>,</span>
<span>  proportion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">age_struct</span></span>
<span><span class="co">#&gt;   age_limit proportion</span></span>
<span><span class="co">#&gt; 1         1        0.4</span></span>
<span><span class="co">#&gt; 2        10        0.3</span></span>
<span><span class="co">#&gt; 3        30        0.2</span></span>
<span><span class="co">#&gt; 4        60        0.1</span></span>
<span><span class="co">#&gt; 5        75        0.0</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_linelist.html">sim_linelist</a></span><span class="op">(</span></span>
<span>  contact_distribution <span class="op">=</span> <span class="va">contact_distribution</span>,</span>
<span>  infectious_period <span class="op">=</span> <span class="va">infectious_period</span>,</span>
<span>  prob_infection <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  onset_to_hosp <span class="op">=</span> <span class="va">onset_to_hosp</span>,</span>
<span>  onset_to_death <span class="op">=</span> <span class="va">onset_to_death</span>,</span>
<span>  population_age <span class="op">=</span> <span class="va">age_struct</span>,</span>
<span>  outbreak_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1e4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id         case_name case_type sex age date_onset date_reporting</span></span>
<span><span class="co">#&gt; 1  1    Kylie Castillo suspected   f   7 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 2  2 Mu,Aawiya al-Amir  probable   m  45 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 3  4     Drue Ashworth suspected   m  53 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 4  5  Anthony Suddreth confirmed   m   3 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt; 5  6    Victoria Smith  probable   f  20 2023-01-04     2023-01-04</span></span>
<span><span class="co">#&gt; 6  8   Naafoora el-Haq  probable   f  14 2023-01-01     2023-01-01</span></span>
<span><span class="co">#&gt;   date_admission   outcome date_outcome date_first_contact date_last_contact</span></span>
<span><span class="co">#&gt; 1           &lt;NA&gt; recovered         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2     2023-01-19      died   2023-01-19         2022-12-28        2023-01-02</span></span>
<span><span class="co">#&gt; 3           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-02        2023-01-04</span></span>
<span><span class="co">#&gt; 4     2023-01-10 recovered         &lt;NA&gt;         2022-12-31        2023-01-06</span></span>
<span><span class="co">#&gt; 5           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-05        2023-01-06</span></span>
<span><span class="co">#&gt; 6           &lt;NA&gt; recovered         &lt;NA&gt;         2023-01-02        2023-01-05</span></span>
<span><span class="co">#&gt;   ct_value</span></span>
<span><span class="co">#&gt; 1       NA</span></span>
<span><span class="co">#&gt; 2       NA</span></span>
<span><span class="co">#&gt; 3       NA</span></span>
<span><span class="co">#&gt; 4     21.8</span></span>
<span><span class="co">#&gt; 5       NA</span></span>
<span><span class="co">#&gt; 6       NA</span></span></code></pre></div>
<p>A common and useful method for plotting age data is in the form of
age pyramids. Here we partition the data by sex and plot the age
distribution.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">linelist</span>, subset <span class="op">=</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"m"</span><span class="op">)</span></span>
<span><span class="va">age_cats_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">linelist_m</span><span class="op">$</span><span class="va">age</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">age_cats_m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AgeCat"</span>, <span class="st">"Population"</span><span class="op">)</span></span>
<span><span class="va">age_cats_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">age_cats_m</span>, sex <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span><span class="va">linelist_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">linelist</span>, subset <span class="op">=</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="va">age_cats_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">linelist_f</span><span class="op">$</span><span class="va">age</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">age_cats_f</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AgeCat"</span>, <span class="st">"Population"</span><span class="op">)</span></span>
<span><span class="va">age_cats_f</span><span class="op">$</span><span class="va">Population</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">age_cats_f</span><span class="op">$</span><span class="va">Population</span></span>
<span><span class="va">age_cats_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">age_cats_f</span>, sex <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="va">age_cats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">age_cats_m</span>, <span class="va">age_cats_f</span><span class="op">)</span></span>
<span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">age_cats</span><span class="op">$</span><span class="va">Population</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">age_cats</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Population</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AgeCat</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Lower bound of Age Category"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Population"</span>, breaks <span class="op">=</span> <span class="va">breaks</span>, labels <span class="op">=</span> <span class="va">labels</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F04A4C"</span>, <span class="st">"#106BA0"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="age-struct-pop_files/figure-html/plot-age-struct-young-1.png" alt="Age pyramid for a simulated line list with an age-structured population." width="768"><p class="caption">
Age pyramid for a simulated line list with an age-structured population.
</p>
</div>
<p>We have used the {ggplot2} package to construct our age pyramid,
however the <a href="https://r4epi.github.io/apyramid/" class="external-link">{apyramid} R
package from R4Epi</a> can assist in making these plots; as can the <a href="https://www.epirhandbook.com/en/new_pages/age_pyramid.html" class="external-link">Applied
Epidemiology Handbook chapter on age pyramids</a>. The blog post on <a href="https://www.njtierney.com/post/2022/08/09/ggplot-pyramid/" class="external-link">“Population
Pyramid Plots in ggplot2”</a> also contains useful tips on constructing
pyramid plots.</p>
<p>As shown in the two age-structured examples, the number of age groups
is flexible. Therefore a coarse population structure with two or three
age groups can be specified, or where precise census demographic data is
available, several age groups can be specified.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Carmen Tamayo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
